{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>snombre</th>\n",
       "      <th>apellido</th>\n",
       "      <th>nacionalidad</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Henedina</td>\n",
       "      <td>Cantolla</td>\n",
       "      <td>Belga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Anna Monika</td>\n",
       "      <td>Fatih</td>\n",
       "      <td>Griega</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Larissa</td>\n",
       "      <td>Sangucho</td>\n",
       "      <td>Japonesa</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Mario Ruben</td>\n",
       "      <td>Colombo</td>\n",
       "      <td>Egipcia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Oliver James</td>\n",
       "      <td>Piles</td>\n",
       "      <td>Boliviana</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        snombre  apellido nacionalidad\n",
       "0      Henedina  Cantolla        Belga\n",
       "1   Anna Monika     Fatih       Griega\n",
       "2       Larissa  Sangucho     Japonesa\n",
       "3   Mario Ruben   Colombo      Egipcia\n",
       "4  Oliver James     Piles    Boliviana"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "dfp = pd.read_csv(\"proyectos.csv\")\n",
    "dfr = pd.read_csv(\"recursos.csv\", decimal=',')\n",
    "dfsocios = pd.read_csv(\"socios.csv\", decimal=',')\n",
    "\n",
    "dfsocios.rename(columns={'nombre':'snombre', 'apellido': 'apellido'}, inplace=True)\n",
    "dfsocios.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pnombre</th>\n",
       "      <th>latitud</th>\n",
       "      <th>longitud</th>\n",
       "      <th>comuna</th>\n",
       "      <th>fecha apertura</th>\n",
       "      <th>operativo</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>SolarEdge Technologies, Inc.</td>\n",
       "      <td>-40.611245</td>\n",
       "      <td>-71.976399</td>\n",
       "      <td>Padre Hurtado</td>\n",
       "      <td>18-01-2012</td>\n",
       "      <td>si</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Azul S.A.</td>\n",
       "      <td>-38.371222</td>\n",
       "      <td>-72.545869</td>\n",
       "      <td>Curanilahue</td>\n",
       "      <td>08-02-1963</td>\n",
       "      <td>si</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Franke</td>\n",
       "      <td>-46.572204</td>\n",
       "      <td>-70.575490</td>\n",
       "      <td>Calama</td>\n",
       "      <td>09-04-2016</td>\n",
       "      <td>si</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AdvisorShares Market Adaptive Unconstrained In...</td>\n",
       "      <td>-19.487575</td>\n",
       "      <td>-73.465824</td>\n",
       "      <td>Chile Chico</td>\n",
       "      <td>06-10-1992</td>\n",
       "      <td>si</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Kilroy Realty Corporation</td>\n",
       "      <td>-45.982461</td>\n",
       "      <td>-71.805166</td>\n",
       "      <td>Huasco</td>\n",
       "      <td>16-09-1962</td>\n",
       "      <td>si</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             pnombre    latitud   longitud  \\\n",
       "0                       SolarEdge Technologies, Inc. -40.611245 -71.976399   \n",
       "1                                          Azul S.A. -38.371222 -72.545869   \n",
       "2                                             Franke -46.572204 -70.575490   \n",
       "3  AdvisorShares Market Adaptive Unconstrained In... -19.487575 -73.465824   \n",
       "4                          Kilroy Realty Corporation -45.982461 -71.805166   \n",
       "\n",
       "          comuna fecha apertura operativo  \n",
       "0  Padre Hurtado     18-01-2012        si  \n",
       "1    Curanilahue     08-02-1963        si  \n",
       "2         Calama     09-04-2016        si  \n",
       "3    Chile Chico     06-10-1992        si  \n",
       "4         Huasco     16-09-1962        si  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfproyectos = dfp.drop(['tipo', 'región', 'mineral', 'tipo generación', 'socios'], axis=1)\n",
    "dfproyectos.rename(columns={'nombre':'pnombre'}, inplace=True)\n",
    "dfproyectos.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>apellido</th>\n",
       "      <th>pnombre</th>\n",
       "      <th>snombre</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Betolaza</td>\n",
       "      <td>SolarEdge Technologies, Inc.</td>\n",
       "      <td>Gemma</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Paunero</td>\n",
       "      <td>SolarEdge Technologies, Inc.</td>\n",
       "      <td>Marta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Ortiz</td>\n",
       "      <td>Azul S.A.</td>\n",
       "      <td>Raul</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Tricio</td>\n",
       "      <td>Azul S.A.</td>\n",
       "      <td>Elena</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pisabarro</td>\n",
       "      <td>Azul S.A.</td>\n",
       "      <td>Rosario</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    apellido                       pnombre  snombre\n",
       "0   Betolaza  SolarEdge Technologies, Inc.    Gemma\n",
       "1    Paunero  SolarEdge Technologies, Inc.    Marta\n",
       "2      Ortiz                     Azul S.A.     Raul\n",
       "3     Tricio                     Azul S.A.    Elena\n",
       "4  Pisabarro                     Azul S.A.  Rosario"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfsyp500 = pd.DataFrame()\n",
    "\n",
    "n = dfsocios['snombre']\n",
    "a = dfsocios['apellido']\n",
    "na = [x+' '+y for x,y in zip(n,a)]\n",
    "\n",
    "for i, row in dfp.iterrows():\n",
    "    socios = row['socios'].split(',')\n",
    "    for socio in socios:\n",
    "        nombre = n[na.index(socio)]\n",
    "        apellido = a[na.index(socio)]\n",
    "        dfsyp500 = dfsyp500.append({'snombre': nombre, 'apellido': apellido, 'pnombre': row['nombre']}, ignore_index=True)\n",
    "\n",
    "\n",
    "dfsyp500.head()"
   ]
  },
  {
   "cell_type": "code",
<<<<<<< Updated upstream
   "execution_count": 50,
=======
   "execution_count": 20,
>>>>>>> Stashed changes
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>numero</th>\n",
       "      <th>causa contaminante</th>\n",
       "      <th>area</th>\n",
       "      <th>descripcion</th>\n",
       "      <th>fecha apertura</th>\n",
       "      <th>comuna</th>\n",
       "      <th>status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>75773-26740-LB</td>\n",
       "      <td>mal olor</td>\n",
       "      <td>29.76</td>\n",
       "      <td>Maecenas tristique, est et tempus semper, est ...</td>\n",
       "      <td>09/10/1995</td>\n",
       "      <td>Doñihue</td>\n",
       "      <td>aprobado</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>34339-73469-DD</td>\n",
       "      <td>ruido</td>\n",
       "      <td>26.64</td>\n",
       "      <td>Curabitur in libero ut massa volutpat convalli...</td>\n",
       "      <td>12/09/2010</td>\n",
       "      <td>Vitacura</td>\n",
       "      <td>aprobado</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>54011-96023-OK</td>\n",
       "      <td>contaminación de agua</td>\n",
       "      <td>41.70</td>\n",
       "      <td>Quisque id justo sit amet sapien dignissim ves...</td>\n",
       "      <td>02/11/2007</td>\n",
       "      <td>Paine</td>\n",
       "      <td>rechazado</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2244-72747-GF</td>\n",
       "      <td>contaminación de agua</td>\n",
       "      <td>43.11</td>\n",
       "      <td>Proin interdum mauris non ligula pellentesque ...</td>\n",
       "      <td>22/03/2014</td>\n",
       "      <td>Lolol</td>\n",
       "      <td>rechazado</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>17957-30003-BH</td>\n",
       "      <td>radiación</td>\n",
       "      <td>36.27</td>\n",
       "      <td>Vestibulum ac est lacinia nisi venenatis trist...</td>\n",
       "      <td>10/06/2003</td>\n",
       "      <td>Nancagua</td>\n",
       "      <td>rechazado</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           numero     causa contaminante   area  \\\n",
       "0  75773-26740-LB               mal olor  29.76   \n",
       "1  34339-73469-DD                  ruido  26.64   \n",
       "2  54011-96023-OK  contaminación de agua  41.70   \n",
       "3   2244-72747-GF  contaminación de agua  43.11   \n",
       "4  17957-30003-BH              radiación  36.27   \n",
       "\n",
       "                                         descripcion fecha apertura    comuna  \\\n",
       "0  Maecenas tristique, est et tempus semper, est ...     09/10/1995   Doñihue   \n",
       "1  Curabitur in libero ut massa volutpat convalli...     12/09/2010  Vitacura   \n",
       "2  Quisque id justo sit amet sapien dignissim ves...     02/11/2007     Paine   \n",
       "3  Proin interdum mauris non ligula pellentesque ...     22/03/2014     Lolol   \n",
       "4  Vestibulum ac est lacinia nisi venenatis trist...     10/06/2003  Nancagua   \n",
       "\n",
       "      status  \n",
       "0   aprobado  \n",
       "1   aprobado  \n",
       "2  rechazado  \n",
       "3  rechazado  \n",
       "4  rechazado  "
      ]
     },
<<<<<<< Updated upstream
     "execution_count": 50,
=======
     "execution_count": 20,
>>>>>>> Stashed changes
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfrecursos = dfr.drop(['nombre', 'región de tramitación', 'fecha_dictamen', 'ONGs que participan'], axis=1)\n",
    "dfr.rename(columns={'comuna de tramitación': 'comuna', \n",
    "                                 'descripción' : 'descripcion', \n",
    "                                 'área influencia (kms)': 'area',\n",
    "                                 'número': 'numero'}, inplace=True)\n",
    "dfrecursos.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>numero</th>\n",
       "      <th>pnombre</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>75773-26740-LB</td>\n",
       "      <td>Celite - Tilviche</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>34339-73469-DD</td>\n",
       "      <td>PureFunds ETFx HealthTech ETF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>54011-96023-OK</td>\n",
       "      <td>RenaissanceRe Holdings Ltd.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2244-72747-GF</td>\n",
       "      <td>Sierra Oncology, Inc.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>17957-30003-BH</td>\n",
       "      <td>Voya Global Equity Dividend and Premium Opport...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           numero                                            pnombre\n",
       "0  75773-26740-LB                                  Celite - Tilviche\n",
       "1  34339-73469-DD                      PureFunds ETFx HealthTech ETF\n",
       "2  54011-96023-OK                        RenaissanceRe Holdings Ltd.\n",
       "3   2244-72747-GF                              Sierra Oncology, Inc.\n",
       "4  17957-30003-BH  Voya Global Equity Dividend and Premium Opport..."
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfpyr400 = pd.DataFrame()\n",
    "p = [x for x in dfp['nombre']]\n",
    "\n",
    "for i, row in dfr.iterrows():\n",
    "    proy = row['nombre'].replace('Recurso contra ', '')\n",
    "    dfpyr400 = dfpyr400.append({'pnombre': proy, 'numero': row['numero']}, ignore_index=True)\n",
    "dfpyr400.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                        pnombre tipo generación\n",
      "0  SolarEdge Technologies, Inc.         nuclear\n",
      "1                     Azul S.A.      geotérmica\n",
      "2     Kilroy Realty Corporation      geotérmica\n",
      "3       Anheuser-Busch Inbev SA  termoeléctrica\n",
      "4      Park-Ohio Holdings Corp.         nuclear\n",
      "  mineral       pnombre\n",
      "0   Cobre        Franke\n",
      "1   Cobre  San Gerónimo\n",
      "2   Cobre       Elenita\n",
      "3  Carbón     Catamutún\n",
      "4   Cobre      San José\n"
     ]
    }
   ],
   "source": [
    "dfmineras = pd.DataFrame()\n",
    "dfcentrales = pd.DataFrame()\n",
    "\n",
    "for i, row in dfp.iterrows():\n",
    "    if row['tipo'] == 1:\n",
    "        mins = row['mineral'].split(',')\n",
    "        for min_ in mins:\n",
    "            dfmineras = dfmineras.append({'pnombre': row['nombre'], 'mineral': min_}, ignore_index=True)\n",
    "    elif row['tipo'] == 2:\n",
    "        dfcentrales = dfcentrales.append({'pnombre': row['nombre'], 'tipo generación': row['tipo generación']}, ignore_index=True)\n",
    "\n",
    "        \n",
    "\n",
    "print(dfcentrales.head())\n",
    "print(dfmineras.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fecha dictamen</th>\n",
       "      <th>numero</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>29-11-2008</td>\n",
       "      <td>75773-26740-LB</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14-05-2015</td>\n",
       "      <td>34339-73469-DD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>22-01-2011</td>\n",
       "      <td>54011-96023-OK</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>31-03-2016</td>\n",
       "      <td>2244-72747-GF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>26-11-2018</td>\n",
       "      <td>17957-30003-BH</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  fecha dictamen          numero\n",
       "0     29-11-2008  75773-26740-LB\n",
       "1     14-05-2015  34339-73469-DD\n",
       "2     22-01-2011  54011-96023-OK\n",
       "3     31-03-2016   2244-72747-GF\n",
       "4     26-11-2018  17957-30003-BH"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dftram = pd.DataFrame()\n",
    "\n",
    "for i, row in dfr.iterrows():\n",
    "    if row['status'] != 'en trámite':\n",
    "        dftram = dftram.append({'numero': row['numero'], 'fecha dictamen': row['fecha_dictamen']}, ignore_index=True)\n",
    "dftram.head()"
   ]
  },
  {
   "cell_type": "code",
<<<<<<< Updated upstream
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fecha_dictamen</th>\n",
       "      <th>número</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>29-11-2008</td>\n",
       "      <td>75773-26740-LB</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14-05-2015</td>\n",
       "      <td>34339-73469-DD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>22-01-2011</td>\n",
       "      <td>54011-96023-OK</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>31-03-2016</td>\n",
       "      <td>2244-72747-GF</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>26-11-2018</td>\n",
       "      <td>17957-30003-BH</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  fecha_dictamen          número\n",
       "0     29-11-2008  75773-26740-LB\n",
       "1     14-05-2015  34339-73469-DD\n",
       "2     22-01-2011  54011-96023-OK\n",
       "3     31-03-2016   2244-72747-GF\n",
       "4     26-11-2018  17957-30003-BH"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dftram = pd.DataFrame()\n",
    "\n",
    "for i, row in dfr.iterrows():\n",
    "    if row['status'] != 'en trámite':\n",
    "        dftram = dftram.append({'número': row['número'], 'fecha_dictamen': row['fecha_dictamen']}, ignore_index=True)\n",
    "dftram.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
=======
   "execution_count": 32,
>>>>>>> Stashed changes
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>comuna</th>\n",
       "      <th>region</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Padre Hurtado</td>\n",
       "      <td>Metropolitana de Santiago</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Curanilahue</td>\n",
       "      <td>VII del Maule</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Calama</td>\n",
       "      <td>II de Antofagasta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Chile Chico</td>\n",
       "      <td>XI de Aysén del General Carlos Ibañez del Campo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Huasco</td>\n",
       "      <td>III de Atacama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          comuna                                           region\n",
       "0  Padre Hurtado                        Metropolitana de Santiago\n",
       "1    Curanilahue                                    VII del Maule\n",
       "2         Calama                                II de Antofagasta\n",
       "3    Chile Chico  XI de Aysén del General Carlos Ibañez del Campo\n",
       "4         Huasco                                   III de Atacama"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
<<<<<<< Updated upstream
    "dfcyr = pd.DataFrame()\n",
    "\n",
    "comunas = []\n",
    "\n",
    "for i, row in dfr.iterrows():\n",
    "    aux = {'comuna': row['comuna'], 'region': row['region']}\n",
    "    if not aux not in comunas:\n",
    "        dftram = dftram.append(aux, ignore_index=True)\n",
    "        comunas.append(aux)"
=======
    "dfcom = pd.DataFrame()\n",
    "\n",
    "comunas = set()\n",
    "\n",
    "for i, row in dfp.iterrows():\n",
    "    if row['comuna'] not in comunas:\n",
    "        dfcom = dfcom.append({'comuna': row['comuna'], 'region': row['región']}, ignore_index = True)\n",
    "        comunas.add(row['comuna'])\n",
    "\n",
    "dfcom.head()"
>>>>>>> Stashed changes
   ]
  },
  {
   "cell_type": "code",
<<<<<<< Updated upstream
   "execution_count": 51,
=======
   "execution_count": 31,
>>>>>>> Stashed changes
   "metadata": {},
   "outputs": [],
   "source": [
    "dfproyectos.to_csv(\"psql_proyectos.csv\", index=False)\n",
    "dfsocios.to_csv(\"psql_socios.csv\", index=False)\n",
    "dfrecursos.to_csv(\"psql_recursos.csv\", index=False)\n",
    "dfsyp500.to_csv(\"psql_syp.csv\", index=False)\n",
    "dfpyr400.to_csv(\"psql_ryp.csv\", index=False)\n",
    "dfmineras.to_csv(\"psql_mineras.csv\", index=False)\n",
    "dfcentrales.to_csv(\"psql_centrales.csv\", index=False)\n",
<<<<<<< Updated upstream
    "dftram.to_csv(\"psql_tramitados.csv\", index=False)"
=======
    "dftram.to_csv(\"psql_tramitados.csv\", index=False)\n",
    "dfcom.to_csv(\"psql_comunas.csv\", index=False)"
>>>>>>> Stashed changes
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
